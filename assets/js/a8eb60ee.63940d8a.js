"use strict";(self.webpackChunkSPO600=self.webpackChunkSPO600||[]).push([[7458],{3905:function(e,t,r){r.d(t,{Zo:function(){return c},kt:function(){return d}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var p=n.createContext({}),u=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},c=function(e){var t=u(e.components);return n.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},f=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),f=u(r),d=o,m=f["".concat(p,".").concat(d)]||f[d]||s[d]||i;return r?n.createElement(m,a(a({ref:t},c),{},{components:r})):n.createElement(m,a({ref:t},c))}));function d(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=r.length,a=new Array(i);a[0]=f;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:o,a[1]=l;for(var u=2;u<i;u++)a[u]=r[u];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}f.displayName="MDXCreateElement"},3278:function(e,t,r){r.r(t),r.d(t,{assets:function(){return p},contentTitle:function(){return a},default:function(){return s},frontMatter:function(){return i},metadata:function(){return l},toc:function(){return u}});var n=r(3117),o=(r(7294),r(3905));const i={id:"profiling",title:"Profiling",sidebar_position:15,description:"Profiling"},a="Profiling",l={unversionedId:"D-ExtraResources/profiling",id:"D-ExtraResources/profiling",title:"Profiling",description:"Profiling",source:"@site/docs/D-ExtraResources/profiling.md",sourceDirName:"D-ExtraResources",slug:"/D-ExtraResources/profiling",permalink:"/SPO600/D-ExtraResources/profiling",draft:!1,editUrl:"https://github.com/Seneca-ICTOER/SPO600/tree/main/docs/D-ExtraResources/profiling.md",tags:[],version:"current",sidebarPosition:15,frontMatter:{id:"profiling",title:"Profiling",sidebar_position:15,description:"Profiling"},sidebar:"courseNotesSidebar",previous:{title:"Public Key Cryptography",permalink:"/SPO600/D-ExtraResources/public-key-cryptography"},next:{title:"Profile Guided Optimization",permalink:"/SPO600/D-ExtraResources/profile-guided-optimization"}},p={},u=[{value:"Resource that can be Profiled",id:"resource-that-can-be-profiled",level:2},{value:"Profiling Granularity and Techniques",id:"profiling-granularity-and-techniques",level:2},{value:"Profiling Tools",id:"profiling-tools",level:2},{value:"Example: Profiling with &#39;gprof&#39;",id:"example-profiling-with-gprof",level:3},{value:"Example: Profiling with perf",id:"example-profiling-with-perf",level:3},{value:"Optional Lab",id:"optional-lab",level:3}],c={toc:u};function s(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"profiling"},"Profiling"),(0,o.kt)("p",null,"Profiling is the process of determining how a program is using the resources that it is consuming."),(0,o.kt)("h2",{id:"resource-that-can-be-profiled"},"Resource that can be Profiled"),(0,o.kt)("p",null,"Profiling produces a clear view of the call graph -- the hierarchy of function/procedure/method calls that takes place during the execution of the program."),(0,o.kt)("p",null,"Resources consumption that can be analyzed during profiling include:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Time (both clock time (total real time, user time, and the amount of time the kernel spent on behalf of the program)"),(0,o.kt)("li",{parentName:"ul"},"Memory"),(0,o.kt)("li",{parentName:"ul"},"Temporary storage"),(0,o.kt)("li",{parentName:"ul"},"Energy (this is a relatively new area of profiling)")),(0,o.kt)("h2",{id:"profiling-granularity-and-techniques"},"Profiling Granularity and Techniques"),(0,o.kt)("p",null,"Most profiling systems determine resource usage on a per-function basis. Data may be gathered through two different techniques:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Sampling - interrupting the program frequently (such as 10 000 times/second) and determining which function is currently executing (by comparing the ",(0,o.kt)("a",{parentName:"li",href:"/SPO600/E-ComputerArchitecture/register#program-counter"},"program counter")," to the debuginfo of the program)."),(0,o.kt)("li",{parentName:"ol"},"Instrumentation - adding code to the binary or using debug controls (such as ",(0,o.kt)("a",{parentName:"li",href:"/SPO600/E-ComputerArchitecture/debugger"},"breakpoints"),") to determine when and how often specific actions take place, such as entry/exit to/from a function/procedure/method.")),(0,o.kt)("h2",{id:"profiling-tools"},"Profiling Tools"),(0,o.kt)("p",null,"There are many profiling tools available. Open source options include:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"gprof"),(0,o.kt)("li",{parentName:"ul"},"perf"),(0,o.kt)("li",{parentName:"ul"},"oprofile"),(0,o.kt)("li",{parentName:"ul"},"SystemTap")),(0,o.kt)("p",null,"These tools provide different combinations of profiling capabilities, and may provide additional functions."),(0,o.kt)("h3",{id:"example-profiling-with-gprof"},"Example: Profiling with 'gprof'"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"gprof")," tool provides basic profiling capability using a combination of sampling (for times) and instrumentation (for call graph and counts). To use it:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Build the software to be profiled using the ",(0,o.kt)("inlineCode",{parentName:"li"},"-pg")," (profile generation) option to the gcc compiler. This may require that you modify the makefile or other build instructions, but it can often be done using the CFLAGS or CCOPTS variables passed to configure or make -- for example, ",(0,o.kt)("inlineCode",{parentName:"li"},'./configure CFLAGS="-g -pg -O2"')),(0,o.kt)("li",{parentName:"ol"},"Execute the program. Ensure that you give it a typical to long execution time; if it is an interactive program, run through most of the commonly-used features, and if it is non-interactive, invoke it with common options and give it a good amount of data to process."),(0,o.kt)("li",{parentName:"ol"},"Check that a file named ",(0,o.kt)("inlineCode",{parentName:"li"},"gmon.out")," was produced when the program ran. If not, recheck the previous steps."),(0,o.kt)("li",{parentName:"ol"},"Run the ",(0,o.kt)("inlineCode",{parentName:"li"},"gprof")," program to generate a report: ",(0,o.kt)("inlineCode",{parentName:"li"},"gprof filenameOfExecutableBeingProfiled"))),(0,o.kt)("p",null,"The output from gprof is a text report. It can be converted to a graphical representation, which is often more useful, using the ",(0,o.kt)("inlineCode",{parentName:"p"},"gprof2dot"),' script to convert it to the GraphViz "dot" format, then using the ',(0,o.kt)("inlineCode",{parentName:"p"},"dot")," utility to output it in the desired graphics format."),(0,o.kt)("p",null,"Examples:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-assembly"},"# produce a PDF\ngprof nameOfExecutable | gprof2dot | dot -Tps | ps2pdf - gprof.pdf \n\n# produce a PNG file\ngprof nameOfExecutable | gprof2dot | dot -Tps | convert - gprof.png\n\n# produce an SVG file\ngprof nameOfExecutable | gprof2dot | dot -Tsvg > gprof.svg\n\n# display on the screen\ngprof nameOfExecutable | gprof2dot | dot -Tx11\n")),(0,o.kt)("h3",{id:"example-profiling-with-perf"},"Example: Profiling with perf"),(0,o.kt)("p",null,"Perf does not use instrumentation, so no changes are required to the build process."),(0,o.kt)("p",null,"To record performance data, run perf with the ",(0,o.kt)("inlineCode",{parentName:"p"},"record")," argument: ",(0,o.kt)("inlineCode",{parentName:"p"},"perf record nameOfExecutable")," To display performance data, run perf with the ",(0,o.kt)("inlineCode",{parentName:"p"},"report")," argument: ",(0,o.kt)("inlineCode",{parentName:"p"},"perf report|less")," for non-interactive output, or ",(0,o.kt)("inlineCode",{parentName:"p"},"perf report")," for interactive display"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Function vs. Method vs. Procedure")),(0,o.kt)("p",null,"In procedural languages, called code blocks are often called ",(0,o.kt)("strong",{parentName:"p"},"functions"),". When programming in an object-oriented language, called code blocks may be called ",(0,o.kt)("strong",{parentName:"p"},"methods"),". Older or more general documentation may refer to called code blocks as ",(0,o.kt)("strong",{parentName:"p"},"procedures"),'. The distinction between functions, methods, and procedures is effectively one of terminology and "packaging" only - at the ',(0,o.kt)("a",{parentName:"p",href:"/SPO600/E-ComputerArchitecture/machine-language"},"machine code")," level, the distinction effectively disappears."),(0,o.kt)("h3",{id:"optional-lab"},"Optional Lab"),(0,o.kt)("p",null,"The SPO600 Profiling Lab was used in previous semesters in the SPO600 course. It is not a required lab in the current version of the course."))}s.isMDXComponent=!0}}]);